---

- name: CONFUGURATION (all)
  hosts: all
  tasks:

    - name: dnf or apt update
      include_tasks: rules/rule_apt_dnf_update.yml

    - name: hostname configuration
      include_tasks: templates/system/template_conf_hostname.yml

    - name: dhclient configuration
      include_tasks: templates/system/template_conf_dhclient.yml

- name: DEPLOY PRODUCTION (mastodon)
  hosts: mastodon
  tasks:

    - name: system configuration
      include_tasks: tasks_dependencies/task_system.yml

    - name: dependencies installations
      include_tasks: tasks_dependencies/task_dependencies_installations.yml

    - name: db installation and configuration
      include_tasks: tasks_dependencies/task_db.yml

    - name: mastodon installation and configuration
      include_tasks: tasks_dependencies/task_mastodon.yml